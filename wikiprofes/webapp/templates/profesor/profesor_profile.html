{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block classI %}
    <li>
        <a href="{% url 'inicio'%}" aria-expanded="false">
            <i class="ti-home menu-icon"></i><span class="nav-text">Inicio</span>
        </a>
    </li>
{% endblock classI %}

{% block content %}
    <div class="barra contenedor card">
        <form  class="contenedor mt-5 mb-5 login-input" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <fieldset class="form-group">
                <legend class = "border-bottom mb-4">Información del Profesor</legend>
                {{ u_form|crispy }}
                {{ p_form|crispy }}
            </fieldset>
            <div class="contenedor media">
                <img class="rounded-circle account-img" style="max-height:120px; max-width:120px;">
                <div class="media-body">
                    <h3 class="account-heading">Profesor: {{ profesor.nombre }}</h3>
                    <p class="text-secondary">{{ profesor.correo }}</p>
                    {%for materia in profesor.materia.all %}
                        <p>{{materia}}</p>
                    {%endfor%}
                    
                    {% if user.is_superuser %}
                        <a href="{% url 'update_profesor' profesor.idProfesor %}" class="btn login-form__btn submit">Editar</a>
                    {% endif %}
                    
                </div>
                
            </div>

        </form>

    </div>

    <div class="barra contenedor card">
        <form class="contenedor mt-5 mb-5 login-input">
            {% csrf_token %}
            <fieldset class="form-group">
                <legend class = "border-bottom mb-4">Calificaciones</legend>
                
            </fieldset>
            <div class="contenedor media">
                <img class="rounded-circle account-img" style="max-height:120px; max-width:120px;">
                <div class="media-body">
                    
                    {% if not profesor.calificaciones.all %}
                        No hay calificación aún...
                        <br> 
                    {% else %}
                    <table class="table table-striped table-hover table-responsive-sm">
                        <tr>
                            <th>Puntualidad</th>
                            <th>Facilidad</th>
                            <th>Dificuldad del curso</th>
                            <th>Dominio del tema</th>  
                        </tr>
                        <script>
                            var prom=0;
                            var i=0;
                            {% for calif in profesor.calificaciones.all  %}
                                prom = prom + {{ calif.calificacion }};
                                i=i+1;
                            {% endfor %}
                            prom = prom/i;
                            prom.toFixed(2);
                            document.write("<h1><strong>Calificación: " + prom +"</strong></h1>");
                            
                        </script>
                        
                        {% for calif in profesor.calificaciones.all %}

                            <tr>
                                <td>{{ calif.puntualidad }}</td>
                                <td>{{ calif.facilidad }}</td>
                                <td>{{ calif.dificultad }}</td>
                                <td>{{ calif.dominioDelTema }}</td>
                            </tr>
                        
                        {% endfor %}
                        
                    {% endif %}
                    <br>
                    <br>
                    </table>
                    {% if user.is_authenticated %}       
                        <a style="font-size: 18px; font-weight: bold; color: #6E41E2;" href= "{% url "add_calif" profesor.idProfesor %}">
                            Agregar calificación
                        </a>
                        <br>
                    {% endif %}
                </div>
            </div> 

        </form> 

    </div>   

    <div class="barra contenedor card">
        <form class="contenedor mt-5 mb-5 login-input">
 
            {% csrf_token %}
            <fieldset class="form-group">
                <legend class = "border-bottom mb-4">Comentarios</legend>
                
            </fieldset>
            <div class="contenedor media">
                <img class="rounded-circle account-img" style="max-height:120px; max-width:120px;">
                <div class="media-body">
                    
                    {% if not profesor.comentarios.all %}
                        No hay comentarios aún...
                        <br> 
                    
                    {% else %}
                        {% for comment in profesor.comentarios.all %}
                            <strong>{{comment.fecha}}</strong>
                            <br>
                            {{comment.comentario}}
                            <hr>
                            <br>
                            
                        {% endfor %}
                        
                    {% endif %}
                    <br>
                    <br>
                    {% if user.is_authenticated %}       
                        
                        <a style="font-size: 18px; font-weight: bold; color: #6E41E2;" href= "{% url "add_comment" profesor.idProfesor %}">
                        Agregar comentario
                        </a>
                            <br>
                        <br>
                        <br>
                    {% endif %}
                </div>
            </div>

        </form>

    </div>

{% endblock content%}
   